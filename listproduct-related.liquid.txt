<section class="productDetail-related">
	<div class="container container-pd0">
		<div class="productRelated-title">
			<h2>{{settings.product_related_title}}</h2>
		</div>

		{% assign cp = product %}
		{% assign number_of_related_products_to_show = 8 %}
		{% assign number_of_related_products_to_fetch = number_of_related_products_to_show %}

		{% if collection == null or collection.handle == 'frontpage' or collection.handle == 'all' %}
		{% assign found_a_collection = false %}
		{% for c in product.collections %}
		{% if found_a_collection == false and c.handle != 'frontpage' and c.handle != 'all' and c.all_products_count > 1 %}
		{% assign found_a_collection = true %}
		{% assign collection = c %}
		{% endif %}
		{% endfor %}
		{% endif %}

		{% if collection and collection.products_count > 1 %}
		<div class="productRelated-content">
			<div class="listProduct-related listProduct-row owlCarousel-dfex owl-carousel owlCarousel-style" id="owlProduct-related">
				{% assign current_product = product %}
				{% assign current_product_found = false %}
				{% assign counter_p = 0 %}

				{% for product in collection.products%}
				{%if counter_p >= number_of_related_products_to_show%}
				{%break%}
				{%endif%}

				{%if cp.handle != product.handle %}
					{% include 'product-loop-slider' with section: 'listProdRelated' %}
				{%assign counter_p =counter_p | plus : 1%}
				{%endif%}
				{% endfor %}
			</div>
		</div>			
		{%else%}
		{%if collections.all.products.size > 0%}
		<div class="productRelated-content">
			<div class="listProduct-related listProduct-row listProduct-resize owl-carousel owlCarousel-style" id="owlProduct-related">
				{% for product in collections.all.products limit: number_of_related_products_to_fetch %}
				{%if cp.handle != product.handle %}
				{% include 'product-loop-slider' with section: 'listProdRelated' %}
				{%endif%}
				{% endfor %}
			</div>
		</div>		
		{%- else -%}<p>Không tìm thấy sản phẩm nào</p>{%- endif -%}
		{%- endif -%}	
	</div>	
</section>
